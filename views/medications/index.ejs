<%- include('../partials/header') %>
<h1>My Medications</h1>

<form class="card form" action="/medications" method="post">
  <div class="row">
    <label>Name<input name="name" required></label>
    <label>Dosage<input name="dosage" placeholder="e.g., 500mg" required></label>
    <label>Times/day<input type="number" name="timesPerDay" min="1" max="6" value="1" required></label>
  </div>
  <fieldset>
    <legend>Timing</legend>
    <% ['morning','afternoon','evening','before food','after food','before bed'].forEach(t => { %>
      <label class="checkbox">
        <input type="checkbox" name="timing" value="<%= t %>"> <%= t %>
      </label>
    <% }) %>
  </fieldset>
  <label>Notes<textarea name="notes" rows="2"></textarea></label>
  <button class="btn">Add medication</button>
</form>

<div class="list">
  <% meds.forEach(m => { %>
    <div class="card list-item">
      <div>
        <h3><%= m.name %></h3>
        <p class="muted"><%= m.dosage %> • <%= m.timesPerDay %>×/day • <%= (m.timing||[]).join(', ') %></p>
        <% if (m.notes) { %><p><%= m.notes %></p><% } %>
      </div>
      <div class="actions">
        <a class="btn-out" href="/medications/<%= m._id %>/edit">Edit</a>
        <form action="/medications/<%= m._id %>/delete" method="post" onsubmit="return confirm('Delete this medication?');">
          <button class="btn-danger">Delete</button>
        </form>
      </div>
    </div>
  <% }) %>
</div>
<%- include('../partials/footer') %>