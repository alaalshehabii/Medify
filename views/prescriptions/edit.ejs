<div class="card">
  <h2>Edit Prescription</h2>
  <form method="POST" action="/prescriptions/<%= prescription._id %>?_method=PUT">
    <div class="field">
      <label>Patient</label>
      <select name="patient_id" required>
        <% (patients||[]).forEach(p => { %>
          <option value="<%= p._id %>" <%= (prescription.patient_id?.toString() === p._id.toString()) ? 'selected' : '' %>><%= p.full_name %></option>
        <% }) %>
      </select>
    </div>
    <div class="field">
      <label>Medication</label>
      <select name="medication_id" required>
        <% (medications||[]).forEach(m => { %>
          <option value="<%= m._id %>" <%= (prescription.medication_id?.toString() === m._id.toString()) ? 'selected' : '' %>><%= m.name %></option>
        <% }) %>
      </select>
    </div>
    <div class="field"><label>Dosage</label><input name="dosage" value="<%= prescription.dosage||'' %>"></div>
    <div class="field"><label>Frequency</label><input name="frequency" value="<%= prescription.frequency||'' %>"></div>
    <div class="field"><label>Start date</label><input type="date" name="start_date" value="<%= prescription.start_date ? prescription.start_date.toISOString().slice(0,10) : '' %>"></div>
    <div class="field"><label>End date</label><input type="date" name="end_date" value="<%= prescription.end_date ? prescription.end_date.toISOString().slice(0,10) : '' %>"></div>
    <div class="field"><label>Refills</label><input type="number" name="refills" value="<%= prescription.refills ?? 0 %>" min="0"></div>
    <button class="btn">Save</button>
  </form>
  <form method="POST" action="/prescriptions/<%= prescription._id %>?_method=DELETE" style="margin-top:10px">
    <button class="btn" style="background:#e05b5b">Delete</button>
  </form>
</div>
